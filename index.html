<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body { font-family: sans-serif; }
      .glass { background: rgba(255, 255, 255, 0.9); border: 1px solid #ddd; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <div class="glass p-8 rounded-xl w-full max-w-lg shadow-xl">
        <div class="text-center mb-6">
            <h1 class="text-3xl font-bold text-gray-800">Memo<span class="text-indigo-600">Pulse</span></h1>
            <p class="text-gray-500 text-sm">Automate Your Minutes</p>
        </div>

        <form id="pulseForm" class="space-y-4">
            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase">Recipient Email</label>
                <input type="email" name="email" required placeholder="boss@company.com"
                    class="w-full mt-1 p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
            </div>

            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase">Audio File</label>
                <input type="file" name="audioFile" accept="audio/*" required
                    class="w-full mt-1 p-2 border rounded-lg bg-white">
                <p class="text-xs text-gray-400 mt-1">Max size: 10MB (Apps Script Limit)</p>
            </div>

            <button type="button" onclick="submitData()" id="btn"
                class="w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition">
                üî•GENERATE PULSE
            </button>
        </form>

        <div id="status" class="hidden mt-4 text-center text-sm text-indigo-600 animate-pulse">
            Processing... This may take up to 60 or more seconds...
        </div>
        
        <div id="result" class="hidden mt-4 p-4 bg-white rounded border text-sm"></div>
    </div>

    <script>
        function submitData() {
            var form = document.getElementById('pulseForm');
            var btn = document.getElementById('btn');
            var status = document.getElementById('status');
            var result = document.getElementById('result');

            // Simple Validation
            if(!form.email.value || !form.audioFile.files.length) {
                alert("Please fill all fields");
                return;
            }

            // UI Updates
            btn.disabled = true;
            btn.innerText = "Working...";
            status.classList.remove('hidden');
            result.classList.add('hidden');

            // Send to Google Apps Script Backend
            google.script.run
                .withSuccessHandler(function(response) {
                    status.classList.add('hidden');
                    btn.disabled = false;
                    btn.innerText = "Generate Another";

                    if (response.status === 'success') {
                        result.innerHTML = '<span class="text-green-600 font-bold">‚úÖ Sent!</span><br><br>' + response.preview;
                    } else {
                        result.innerHTML = '<span class="text-red-600 font-bold">‚ùå Error:</span> ' + response.message;
                    }
                    result.classList.remove('hidden');
                })
                .withFailureHandler(function(err) {
                    status.classList.add('hidden');
                    btn.disabled = false;
                    btn.innerText = "Try Again";
                    alert("Server Failure: " + err);
                })
                .processForm(form);
        }
    </script>
</body>
</html>